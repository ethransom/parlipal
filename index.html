<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
  </head>
  <body>
    <main class="container-fluid">
      <div class="row">
        <section class="col-4">
          <div class="row">
            <h1 id="timer">0:00</h1>
          </div>
          <div class="row">
            <button class="btn btn-primary"  data-toggle="modal" data-target="#setTimerModal">Set</button>
            <button class="btn btn-primary" id="clearTimer">Clear</button>
            <!-- <button class="btn btn-primary" id="playPause">Pause</button> -->
          </div>
          <div class="row">
            <h2>Speaker's List</h2>

            <form id="speakerSubmission" class="form-inline">
              <input type="text" required class="form-control" id="newSpeaker" placeholder="Add a speaker"/>
              <button type="submit" class="btn btn-primary">Add</button>
            </form>
          </div>
          <div class="row btn-group">
            <button class="btn btn-primary" id="next-speaker">
              Next
            </button>
            <button class="btn btn-danger" id="clear-speakers">
              Clear
            </button>
          </div>

          <div class="row">
            <ul class="list-group" id="speakersList">
            </ul>
          </div>
        </section>
        <section class="col-8">
          <h2>Motion under discussion</h2>

          <div contenteditable="true">
            Edit me!
          </div>

        </section>
      </div>
    </main>

    <!-- set timer modal -->
    <div class="modal fade" id="setTimerModal">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Set Timer</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <label>
              <input type="number" value="5" id="timerValue"/>
              minutes
            </label>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" id="setTimer">Start Timer</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

    <script>
      let $speakersList = $("#speakersList");

      $("#speakerSubmission").submit(function(e) {
        e.preventDefault();

        let $speaker = $("#newSpeaker");

        $speakersList.append(
          $(document.createElement('li')).addClass('list-group-item').append($speaker.val())
        );

        $speaker.val("");

        return false;
      });

      $("#next-speaker").click(function() {
        // lol
        $speakersList.find(":first-child").remove();
      });

      $("#clear-speakers").click(function() {
        $speakersList.children().remove();
      });

      let $timer = $("#timer"), timerPaused = false, timerRemaining = 0;

      function renderTimer() {
        let mins = Math.floor(timerRemaining / (1000 * 60));
        let seconds = Math.floor((timerRemaining % (1000 * 60)) / 1000);
        seconds = seconds + "";
        if (seconds.length != 2) {
          seconds = "0" + seconds;
        }
        $timer.text(mins + ":" + seconds);
      }

      let timerTick = 1000;
      setInterval(function() {
        if (timerPaused) return;

        timerRemaining -= timerTick;

        if (timerRemaining < 0) {
          timerRemaining = 0;
        }

        renderTimer();
      }, timerTick);

      $("#setTimer").click(function () {
        let value = $("#timerValue").val();
        value = parseInt(value);

        timerRemaining = value * 1000 * 60;

        timerPaused = false;

        renderTimer();
      });

      $("#clearTimer").click(function () {
        timerRemaining = 0;
        renderTimer();
      });

      let $playPause = $("#playPause");
      $playPause.click(function () {
        if ($playPause.text() == "Pause") {
          timerPaused = true;
          $playPause.text("Play");
        } else {
          timerPaused = false;
          $playPause.text("Pause");
        }
      });
    </script>
  </body>
</html>
